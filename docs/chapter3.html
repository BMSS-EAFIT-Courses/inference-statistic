<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Biviana Marcela Suárez Sierra">
<title>4&nbsp; Contrastes de hipótesis – Inferencia Estadística</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter4.html" rel="next">
<link href="./chapter2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-241b0f728d524ab724cf38981e173e36.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Inferencia Estadística</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://bimasusi.github.io/"> 
<span class="menu-text">Volver a mi página</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bimasusi/inference-statistic"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0003-2151-3537"> <i class="bi bi-person" role="img">
</i> 
<span class="menu-text">ORCID</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter3.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Contrastes de hipótesis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">INTRODUCCIÓN</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Principios para reducir los datos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Estimación puntual</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Contrastes de hipótesis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimación por intervalos</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#definiciones-b%C3%A1sicas.-contraste-de-hip%C3%B3tesis-simples" id="toc-definiciones-básicas.-contraste-de-hipótesis-simples" class="nav-link active" data-scroll-target="#definiciones-b%C3%A1sicas.-contraste-de-hip%C3%B3tesis-simples"><span class="header-section-number">4.1</span> Definiciones básicas. Contraste de hipótesis simples</a>
  <ul class="collapse">
<li><a href="#tipos-de-errores" id="toc-tipos-de-errores" class="nav-link" data-scroll-target="#tipos-de-errores"><span class="header-section-number">4.1.1</span> Tipos de errores</a></li>
  <li><a href="#algo-de-interpretaci%C3%B3n-con-r" id="toc-algo-de-interpretación-con-r" class="nav-link" data-scroll-target="#algo-de-interpretaci%C3%B3n-con-r"><span class="header-section-number">4.1.2</span> Algo de interpretación con R</a></li>
  <li><a href="#lema-de-neyman-pearson" id="toc-lema-de-neyman-pearson" class="nav-link" data-scroll-target="#lema-de-neyman-pearson"><span class="header-section-number">4.5.1</span> Lema de Neyman-Pearson</a></li>
  </ul>
</li>
  <li>
<a href="#contrastes-uniformemente-m%C3%A1s-potentes" id="toc-contrastes-uniformemente-más-potentes" class="nav-link" data-scroll-target="#contrastes-uniformemente-m%C3%A1s-potentes"><span class="header-section-number">4.6</span> Contrastes uniformemente más potentes</a>
  <ul class="collapse">
<li><a href="#raz%C3%B3n-de-verosimilitud-mon%C3%B3tona.-teorema-de-karlin-rubin." id="toc-razón-de-verosimilitud-monótona.-teorema-de-karlin-rubin." class="nav-link" data-scroll-target="#raz%C3%B3n-de-verosimilitud-mon%C3%B3tona.-teorema-de-karlin-rubin."><span class="header-section-number">4.6.1</span> Razón de verosimilitud monótona. Teorema de Karlin-Rubin.</a></li>
  </ul>
</li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias"><span class="header-section-number">4.7</span> Referencias</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Contrastes de hipótesis</span>
</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Biviana Marcela Suárez Sierra </p>
          </div>
  </div>
    
  
    
  </div>
  


</header><p>Una hipótesis estadística es una conjetura o una afirmación sobre la distribución de una o más variables aleatorias. Un contraste de hipótesis (o un test de hipótesis o una prueba de hipótesis) es un procedimiento para decidir si se acepta o se rechaza una hipótesis.</p>
<section id="definiciones-básicas.-contraste-de-hipótesis-simples" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="definiciones-básicas.-contraste-de-hipótesis-simples">
<span class="header-section-number">4.1</span> Definiciones básicas. Contraste de hipótesis simples</h2>
<ol type="1">
<li>Usualmente se dispone de una muestra <span class="math inline">\(X_1 ,\ldots, X_n\)</span> de una variable aleatoria <span class="math inline">\(X\)</span> con distribución <span class="math inline">\(F\)</span> y función de densidad (o función de masa) <span class="math inline">\(f\)</span> . <strong>Sobre la distribución de <span class="math inline">\(X\)</span> se realizan dos afirmaciones entre las que se debe decidir</strong>.</li>
<li>En general esas dos afirmaciones serán excluyentes.</li>
<li>
<strong>una se llama hipótesis nula y la otra hipótesis alternativa.</strong> Se denotan por <span class="math inline">\(H_0\)</span> y <span class="math inline">\(H_1\)</span>, respectivamente. Se dice que en un test de hipótesis se contrasta <span class="math inline">\(H_0\)</span> frente a <span class="math inline">\(H_1\)</span> .</li>
<li>La hipótesis nula es más conservadora en el sentido de que no será rechazada a menos que la evidencia muestral en su contra sea muy clara.</li>
<li>Esta hipótesis suele establecer un modelo sencillo para la distribución de <span class="math inline">\(X\)</span> (por ejemplo, si <span class="math inline">\(F\)</span> pertenece a una familia paramétrica, <span class="math inline">\(H_0\)</span> fija el valor del parámetro) o bien propone como distribución de <span class="math inline">\(X\)</span> aquella que es comúnmente aceptada como una buena descripción del fenómeno que modeliza <span class="math inline">\(X\)</span>.</li>
<li>La hipótesis alternativa especifica el tipo de alejamiento de la hipótesis nula que podría presentar la distribución de <span class="math inline">\(X\)</span>.</li>
<li>Si un investigador considera que un fenómeno aleatorio no ha estado adecuadamente modelizado hasta ese momento y cree tener una explicación más satisfactoria, propondrá ésta como hipótesis alternativa y el modelo vigente como hipótesis nula.</li>
<li><strong>Sólo si hay evidencia muestral suficiente para rechazar la hipótesis nula, será aceptada la hipótesis alternativa.</strong></li>
</ol>
<p>Podemos distinguir tres tipos de pruebas de hipótesis:</p>
<p>A. Suponemos que <span class="math inline">\(F\)</span> (y <span class="math inline">\(f\)</span> ) pertenecen a una cierta familia paramétrica indexada por un parámetro <span class="math inline">\(\theta \in\Theta\)</span> y planteamos el contraste</p>
<p><span class="math display">\[\left\{ \begin{array}{lcc}
    H_0 &amp;   :  &amp; \theta \in\Theta_0 \\
    \\ H_1 &amp;  : &amp; \theta \in\Theta_1  
\end{array}
\right.\]</span> donde <span class="math inline">\(\Theta_0\cup\Theta_1=\Theta\)</span>, <span class="math inline">\(\Theta_0\cap\Theta_1=\emptyset\)</span></p>
<p>B. Contrastes de bondad de ajuste (goodness-of-fit tests, en inglés): <span class="math display">\[\left\{ \begin{array}{lcc}
H_0 &amp;   :  &amp; f=f_0 \\
\\ H_1 &amp;  : &amp; f\neq f_0  
\end{array}
\right.\]</span></p>
<p>C. Para dos distribuciones <span class="math inline">\(f_0\)</span> y <span class="math inline">\(f_1\)</span> que no necesariamente pertenecen a la misma familia paramétrica, se plantea el contraste <span class="math display">\[\left\{ \begin{array}{lcc}
H_0 &amp;   :  &amp; f=f_0 \\
\\ H_1 &amp;  : &amp; f= f_1  
\end{array}
\right.\]</span></p>
<p>Una <strong>hipótesis simple</strong> es aquella que especifica completamente la distribución de <span class="math inline">\(X\)</span>. En otro caso, se dice que la afirmación es una <strong>hipótesis compuesta</strong>. Por ejemplo, si <span class="math inline">\(f \in \{f_\theta : \theta \in \Theta \mathbb{R}\}\)</span>, la hipótesis <span class="math inline">\(H : \theta = \theta_0\)</span> es una hipótesis simple. La hipótesis <span class="math inline">\(H : \theta &gt; \theta_0\)</span> es compuesta.</p>
<p>Supongamos que se contrasta <span class="math inline">\(H_0\)</span> frente a <span class="math inline">\(H_1\)</span> . Cuando se observa la muestra <span class="math inline">\(\underset{\sim}{x} = (x_1 ,\ldots, x_n )\)</span> se debe decidir si ésta presenta o no evidencia suficiente para rechazar <span class="math inline">\(H_0\)</span> . El subconjunto <span class="math inline">\(C\)</span> del espacio muestral <span class="math inline">\(\mathcal{X}^n\)</span> de muestras para las cuáles se decide rechazar la hipótesis nula en favor de la alternativa se llama <strong>región crítica o región de rechazo del contraste</strong>. El complementario de <span class="math inline">\(C\)</span> se llama <strong>región de aceptación</strong>. Un contraste queda definido por su región crítica <span class="math inline">\(C\)</span>.</p>
<section id="tipos-de-errores" class="level3" data-number="4.1.1"><h3 data-number="4.1.1" class="anchored" data-anchor-id="tipos-de-errores">
<span class="header-section-number">4.1.1</span> Tipos de errores</h3>
<p>El error de tipo I se considera más grave que el error de tipo II, dado que la hipótesis nula es siempre la más conservadora.</p>
<table class="caption-top table">
<thead><tr class="header">
<th></th>
<th>DECISIÓN: Aceptar H₀</th>
<th>DECISIÓN: Rechazar H₀</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>REALIDAD: H₀ cierta</td>
<td>Decisión correcta</td>
<td>Error de TIPO I</td>
</tr>
<tr class="even">
<td>REALIDAD: H₀ falsa</td>
<td>Error de TIPO II</td>
<td>Decisión correcta</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[\begin{eqnarray*}
    \alpha&amp;=&amp;P(\mbox{error tipo I})\\
    &amp;=&amp;P(\mbox{Rechazar $H_0$ cuando $H_0$ es verdadera})\\
    &amp;=&amp;P(\underset{\sim}{x}\in C\mid H_0\mbox{ cierta})
\end{eqnarray*}\]</span></p>
<p><span class="math display">\[\begin{eqnarray*}
    \beta&amp;=&amp;P(\mbox{error tipo II})\\
    &amp;=&amp;P(\mbox{No rechazar $H_0$ cuando $H_0$ es falsa})\\
    &amp;=&amp;P(\underset{\sim}{x}\notin C\mid H_0\mbox{ falsa})
\end{eqnarray*}\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><figcaption>Gráfico de hipótesis</figcaption><p><img src="images/F105.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><strong>Obsérvese que si se desea reducir la probabilidad del error de tipo I, <span class="math inline">\(\alpha = P_F(\underset{\sim}{x}\in C\mid H_0\mbox{ cierta})\)</span>, se habrán de reducir los puntos de la región crítica <span class="math inline">\(C\)</span>, pero ello implica que el conjunto <span class="math inline">\(\bar{C}\)</span>, complementario de <span class="math inline">\(C\)</span>, aumenta y así la probabilidad de error de tipo II, <span class="math inline">\(\beta=P_F(\underset{\sim}{x}\notin C\mid H_0\mbox{ falsa})\)</span>, también crecerá en general.</strong></p>
<ol type="1">
<li>Dado que el error de tipo I se ha considerado más grave que el error de tipo II, la práctica habitual en el contraste de hipótesis es considerar únicamente pruebas que garantizan que la probabilidad de cometer un error de tipo I será inferior a un valor dado <span class="math inline">\(\alpha\)</span> suficientemente pequeño (por ejemplo, <span class="math inline">\(\alpha = 0.01\)</span>; <span class="math inline">\(0.05\)</span>; <span class="math inline">\(0.1\)</span>) y</li>
<li>buscar entre todas ellas aquélla que hace mínima la probabilidad de cometer un error de tipo II.</li>
<li>Al valor <span class="math inline">\(\alpha\)</span> se le llama <strong>nivel de significación del test</strong>.</li>
</ol></section><section id="algo-de-interpretación-con-r" class="level3" data-number="4.1.2"><h3 data-number="4.1.2" class="anchored">
<span class="header-section-number">4.1.2</span> Algo de interpretación con R</h3>
<p><strong>Sensibilidad de <span class="math inline">\(\beta\)</span> respecto a α en una prueba de hipótesis</strong></p>
<p>Cuando se hace una <strong>prueba unilateral</strong> para la media de una Normal con varianza conocida:</p>
<p><strong>Hipótesis nula</strong></p>
<p><span class="math display">\[
H_0: \mu = \mu_0
\]</span></p>
<p><strong>Hipótesis alternativa</strong></p>
<p><span class="math display">\[
H_1: \mu &gt; \mu_0
\]</span></p>
<hr>
<p><strong>Punto crítico</strong></p>
<p>Como estamos en una prueba unilateral para la media de una Normal con varianza conocida:</p>
<ul>
<li>Muestra de tamaño <span class="math inline">\(n\)</span>:<br><span class="math inline">\(\bar{X} \sim N\!\left(\mu, \tfrac{\sigma^2}{n}\right)\)</span>.</li>
<li>Bajo <span class="math inline">\(H_0: \mu = \mu_0\)</span>, rechazamos si</li>
</ul>
<p><span class="math display">\[
\bar{X} &gt; k, \quad \text{donde } k = \mu_0 + z_{1-\alpha}\,\frac{\sigma}{\sqrt{n}}.
\]</span> El error de tipo II ocurre cuando <strong>no rechazamos <span class="math inline">\(H_0\)</span> a pesar de que <span class="math inline">\(\mu = \mu_a &gt; \mu_0\)</span></strong>.</p>
<p><span class="math display">\[
\beta(\alpha) = \Pr(\bar{X} \le k \mid \mu = \mu_a).
\]</span></p>
<p>Bajo <span class="math inline">\(\mu = \mu_a\)</span>:</p>
<p><span class="math display">\[
\bar{X} \sim N\!\left(\mu_a, \tfrac{\sigma^2}{n}\right).
\]</span></p>
<p>Estandarizamos:</p>
<p><span class="math display">\[
Z = \frac{\bar{X} - \mu_a}{\sigma/\sqrt{n}} \sim N(0,1).
\]</span></p>
<p>Entonces:</p>
<p><span class="math display">\[
\Pr(\bar{X} \le k \mid \mu=\mu_a)
= \Pr\!\left( \frac{\bar{X} - \mu_a}{\sigma/\sqrt{n}} \le \frac{k - \mu_a}{\sigma/\sqrt{n}} \right).
\]</span></p>
<p>Recordemos:</p>
<p><span class="math display">\[
k = \mu_0 + z_{1-\alpha}\,\frac{\sigma}{\sqrt{n}}.
\]</span></p>
<p>Por tanto:</p>
<p><span class="math display">\[
\frac{k - \mu_a}{\sigma/\sqrt{n}}
= \frac{\mu_0 - \mu_a}{\sigma/\sqrt{n}} + z_{1-\alpha}.
\]</span></p>
<p>Definimos:</p>
<p><span class="math display">\[
\delta = \frac{\mu_a - \mu_0}{\sigma/\sqrt{n}}.
\]</span></p>
<p>Así:</p>
<p><span class="math display">\[
\frac{k - \mu_a}{\sigma/\sqrt{n}} = z_{1-\alpha} - \delta.
\]</span> Dado que <span class="math inline">\(Z \sim N(0,1)\)</span>:</p>
<p><span class="math display">\[
\Pr(\bar{X} \le k \mid \mu = \mu_a) = \Pr\!\big(Z \le z_{1-\alpha} - \delta\big).
\]</span></p>
<p>Y esa probabilidad se escribe con la función de distribución acumulada de la Normal estándar (<span class="math inline">\(\Phi\)</span>):</p>
<p><span class="math display">\[
\beta(\alpha) = \Phi\!\left(z_{1-\alpha} - \delta\right).
\]</span></p>
<hr>
<p><strong>Probabilidad de error de tipo II</strong></p>
<p>Si en realidad <span class="math inline">\(\mu = \mu_a &gt; \mu_0\)</span>, la probabilidad de cometer un error de tipo II es:</p>
<p><span class="math display">\[
\beta(\alpha) = \Pr(\,\bar{X} \leq k \mid \mu = \mu_a\,)
= \Phi\!\left(z_{1-\alpha} - \delta\right),
\]</span></p>
<p>donde:</p>
<p><span class="math display">\[
\delta = \frac{\mu_a - \mu_0}{\sigma/\sqrt{n}}
\]</span></p>
<hr>
<p><strong>Interpretación didáctica</strong>:<br>
Al <strong>disminuir <span class="math inline">\(\alpha\)</span></strong> (ser más estricto para rechazar <span class="math inline">\(H_0\)</span>), aumenta <span class="math inline">\(\beta\)</span> (es más difícil detectar <span class="math inline">\(H_1\)</span>).</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Parámetros del problema</span></span>
<span><span class="va">mu0</span>  <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="va">mua</span>  <span class="op">&lt;-</span> <span class="fl">16</span>              <span class="co"># media bajo H1</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">4</span>              <span class="co"># desviación conocida</span></span>
<span><span class="va">n</span>     <span class="op">&lt;-</span> <span class="fl">25</span>             <span class="co"># tamaño de muestra</span></span>
<span></span>
<span><span class="co"># Función beta(α) para prueba unilateral Z</span></span>
<span><span class="va">beta_z</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">mu0</span>, <span class="va">mua</span>, <span class="va">sigma</span>, <span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">delta</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mua</span> <span class="op">-</span> <span class="va">mu0</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span> <span class="op">-</span> <span class="va">delta</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Curva beta(α) en una malla de α</span></span>
<span><span class="va">alphas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.20</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">betas</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">alphas</span>, <span class="va">beta_z</span>, mu0<span class="op">=</span><span class="va">mu0</span>, mua<span class="op">=</span><span class="va">mua</span>, sigma<span class="op">=</span><span class="va">sigma</span>, n<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tabla para valores típicos de α</span></span>
<span><span class="va">alpha_star</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">beta_star</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">alpha_star</span>, <span class="va">beta_z</span>, mu0<span class="op">=</span><span class="va">mu0</span>, mua<span class="op">=</span><span class="va">mua</span>, sigma<span class="op">=</span><span class="va">sigma</span>, n<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="va">alpha_star</span>, beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_star</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     alpha   beta
[1,]  0.10 0.5126
[2,]  0.05 0.6535
[3,]  0.01 0.8591</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Gráfica en base R</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">alphas</span>, <span class="va">betas</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2</span>,</span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">~</span><span class="st">"(nivel de significancia)"</span><span class="op">)</span>,</span>
<span>     ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">~</span><span class="st">"(error de tipo II)"</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Sensibilidad de "</span>, <span class="va">beta</span>, <span class="st">" respecto a "</span>, <span class="va">alpha</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Añadir referencias</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">alpha_star</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">alpha_star</span>, <span class="va">beta_star</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">alpha_star</span>, <span class="va">beta_star</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"  β="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_star</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>, pos<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter3_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span><span class="op">)</span>       <span class="co"># diferencias mu_a - mu_0</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">diffs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dif</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mua_i</span> <span class="op">&lt;-</span> <span class="va">mu0</span> <span class="op">+</span> <span class="va">dif</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    alpha <span class="op">=</span> <span class="va">alphas</span>,</span>
<span>    beta  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">alphas</span>, <span class="va">beta_z</span>, mu0<span class="op">=</span><span class="va">mu0</span>, mua<span class="op">=</span><span class="va">mua_i</span>, sigma<span class="op">=</span><span class="va">sigma</span>, n<span class="op">=</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    dif   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Δ = "</span>, <span class="va">dif</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span>, color<span class="op">=</span><span class="va">dif</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span>,</span>
<span>       title<span class="op">=</span><span class="st">"β vs α para distintos tamaños de efecto (Δ = μ_a - μ_0)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter3_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Cuando el efecto <span class="math inline">\((\Delta = \mu_a - \mu_0)\)</span> es mayor, la curva se desplaza hacia abajo:<br>
para el mismo <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> es menor <span class="math inline">\(\;\Rightarrow\;\)</span> la potencia <span class="math inline">\((1-\beta)\)</span> aumenta.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">1e5</span></span>
<span><span class="va">alpha_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_beta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">mu0</span>, <span class="va">mua</span>, <span class="va">sigma</span>, <span class="va">n</span>, <span class="va">B</span><span class="op">=</span><span class="fl">1e5</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">mu0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span> <span class="op">*</span> <span class="va">sigma</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">B</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mua</span>, sd<span class="op">=</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xbar</span> <span class="op">&lt;=</span> <span class="va">k</span><span class="op">)</span>  <span class="co"># proporción de NO-rechazos cuando H1 es verdadera = β</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">beta_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">alpha_vec</span>, <span class="va">sim_beta</span>, mu0<span class="op">=</span><span class="va">mu0</span>, mua<span class="op">=</span><span class="va">mua</span>, sigma<span class="op">=</span><span class="va">sigma</span>, n<span class="op">=</span><span class="va">n</span>, B<span class="op">=</span><span class="va">B</span><span class="op">)</span></span>
<span><span class="va">beta_the</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">alpha_vec</span>, <span class="va">beta_z</span>, mu0<span class="op">=</span><span class="va">mu0</span>, mua<span class="op">=</span><span class="va">mua</span>, sigma<span class="op">=</span><span class="va">sigma</span>, n<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="va">alpha_vec</span>,</span>
<span>      beta_teorico<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_the</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>      beta_sim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">beta_sim</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     alpha beta_teorico beta_sim
[1,]  0.10       0.5126   0.5133
[2,]  0.05       0.6535   0.6534
[3,]  0.01       0.8591   0.8606</code></pre>
</div>
</div>
<hr>
<div id="tip-4.2" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;4.1: Conclusiones
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Reducir <span class="math inline">\(\alpha\)</span> implica aumentar <span class="math inline">\(\beta\)</span>.</p></li>
<li><p>Un mayor tamaño del efecto <span class="math inline">\((\mu_a - \mu_0)\)</span> o un mayor tamaño de muestra <span class="math inline">\(n\)</span> reducen <span class="math inline">\(\beta\)</span>.</p></li>
<li><p>La práctica usual es fijar un <span class="math inline">\(\alpha\)</span> pequeño (0.01, 0.05, 0.1) y luego buscar el diseño que minimice <span class="math inline">\(\beta\)</span> o equivalga a maximizar la potencia del test.</p></li>
</ul>
</div>
</div>
<p>Si el menor valor obtenido <span class="math inline">\(\beta\)</span> para la probabilidad de error de tipo II es inaceptablemente grande, pueden tomarse dos medidas para reducirlo:</p>
<ul>
<li>aumentar la probabilidad de error de tipo I <span class="math inline">\(\alpha\)</span> permitida, o</li>
<li>aumentar el tamaño de la muestra.</li>
</ul>
<p>Supongamos que la distribución de <span class="math inline">\(X\)</span> pertenece a una familia paramétrica <span class="math inline">\(\{f_\theta:\theta \in\Theta\}\)</span> y se contrasta</p>
<p><span class="math display">\[\left\{ \begin{array}{lcc}
H_0 &amp;   :  &amp; \theta \in\Theta_0 \\
\\ H_1 &amp;  : &amp; \theta \in\Theta_1  
\end{array}
\right.\]</span> donde <span class="math inline">\(\Theta_0\cup\Theta_1=\Theta\)</span>, <span class="math inline">\(\Theta_0\cap\Theta_1=\emptyset\)</span>. ::: {#exm-4.1} Suponga que un candidato, Jones, dice que él ganará más de <span class="math inline">\(50\%\)</span> de los votos en una elección urbana y por tanto saldrá como ganador. Como buscamos apoyo para la hipótesis alternativa de que lo dicho por Jones es falso, nuestra hipótesis alternativa es que <span class="math inline">\(p\)</span>, la probabilidad de seleccionar un votante que esté a favor de Jones, es menor que <span class="math inline">\(0.5\)</span>. Si podemos demostrar que los datos apoyan el rechazo de la hipótesis nula <span class="math inline">\(p = 0.5\)</span> (el valor mínimo necesario para conseguir una mayoría) en favor de la hipótesis alternativa <span class="math inline">\(p &lt; 0.5\)</span>, hemos alcanzado nuestro objetivo de investigación. Suponga que <span class="math inline">\(n = 15\)</span> votantes se seleccionan aleatoriamente de una ciudad y se registra <span class="math inline">\(Y\)</span>, el número que está a favor de Jones. Calcule <span class="math inline">\(\alpha\)</span> si seleccionamos <span class="math inline">\(C = \{y \leq 2\}\)</span> como la región de rechazo.</p>
<p>Para la encuesta política de Jones se muestrearon <span class="math inline">\(n=15\)</span> votantes. <span class="math display">\[\begin{eqnarray*}
    H_0&amp;:&amp;p=0.5\\
    H_a&amp;:&amp;p&lt;0.5
\end{eqnarray*}\]</span> Estadístico de prueba es <span class="math inline">\(Y\)</span>.</p>
<ul>
<li>
<span class="math inline">\(Y:\#\)</span> de votantes a favor. <span class="math inline">\(Y\sim Binom(15,\,p)\)</span>
</li>
<li>Región de rechazo RR: <span class="math display">\[RR=\{Y\leq 2\}\]</span>
C'alculo de <span class="math inline">\(\alpha\)</span>: <span class="math display">\[\begin{eqnarray*}
      \alpha&amp;=&amp;P(\mbox{error tipo I})\\
      &amp;=&amp;P(\mbox{Rechazar $H_0$ cuando $H_0$ es verdadera})\\
      &amp;=&amp;P(Y\leq 2\mbox{ cuando }p=0.5)
  \end{eqnarray*}\]</span>
</li>
</ul>
<p><span class="math display">\[\begin{eqnarray*}
        \alpha&amp;=&amp;P(Y\leq 2\mbox{ cuando }p=0.5)\\
        &amp;=&amp;pbinom(2,\,15,\,0.5)\\
        &amp;=&amp;0.003692627
    \end{eqnarray*}\]</span></p>
<p>Asumimos un riesgo muy pequeño (<span class="math inline">\(\alpha=0.004\)</span>), de concluir que Jones perderá si en realidad es el ganador.</p>
<p><span class="math display">\[\begin{eqnarray*}
    \beta(p_1=0.3)&amp;=&amp;P(\mbox{error tipo II})\\
    &amp;=&amp;P(\mbox{No rechazar $H_0$ cuando $H_a$ es verdadera})\\
    &amp;=&amp;P(Y&gt; 2\mbox{ cuando }p=0.3)\\
    &amp;=&amp;1-P(Y\leq 2\mbox{ cuando }p=0.3)\\
    &amp;=&amp;1-pbinom(2,\,15,\,0.3)\\
    &amp;=&amp;0.8731723
\end{eqnarray*}\]</span> Esta prueba nos llevará a concluir que Jones es ganador, aún cuando <span class="math inline">\(p=0.3\)</span>. :::</p>
<div id="def-4.3" class="definition theorem">
<p><span class="theorem-title"><strong>Definition 4.1</strong></span> Se define la <strong>función de potencia</strong> <span class="math inline">\(\eta(\theta)\)</span> del contraste como <span class="math display">\[\eta(\theta)=P_\theta(\underset{\sim}{x}\in C)=\left\{ \begin{array}{lcc}
\alpha &amp;   si &amp; \theta \in\Theta_0 \\
\\ 1-\beta &amp;  si &amp; \theta \in\Theta_1  
\end{array}
\right.\]</span></p>
<p>Para <span class="math inline">\(0\leq\alpha\leq1\)</span>, un contraste de hipótesis con función de potencia <span class="math inline">\(\eta(\theta)\)</span> tiene <strong>tamaño</strong> <span class="math inline">\(\alpha\)</span> si <span class="math display">\[\sup_{\theta\in\Theta_0}\eta(\theta)=\alpha\]</span> Para <span class="math inline">\(0\leq\alpha\leq1\)</span>, un contraste de hipótesis con función de potencia <span class="math inline">\(\eta(\theta)\)</span> tiene <strong>Nivel de significancia</strong> <span class="math inline">\(\alpha\)</span> si <span class="math display">\[\sup_{\theta\in\Theta_0}\eta(\theta)\leq\alpha\]</span></p>
</div>
<p>El conjunto de contrastes con nivel de significación <span class="math inline">\(\alpha\)</span> contiene las pruebas de tamaño <span class="math inline">\(\alpha\)</span>.</p>
<p>Un contraste que minimiza <span class="math inline">\(\beta=P_\theta(\underset{\sim}{x}\in \bar{C}\mid H_1\mbox{ cierta})\)</span> entre aquellos que tienen tamaño <span class="math inline">\(\alpha\)</span> se dice que es el contraste más potente de tamaño <span class="math inline">\(\alpha\)</span> o el mejor contraste de tamaño <span class="math inline">\(\alpha\)</span>.</p>
<div id="tip-4.3" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;4.2: Función de potencia y contrastes más potentes
</div>
</div>
<div class="callout-body-container callout-body">
<section id="función-de-potencia" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="función-de-potencia">
<span class="header-section-number">4.2</span> 1. Función de potencia</h2>
<p>La <strong>función de potencia</strong> de una prueba mide, para cada valor posible del parámetro <span class="math inline">\(\theta\)</span>, la probabilidad de <strong>rechazar la hipótesis nula</strong>:</p>
<p><span class="math display">\[
\eta(\theta) = P_\theta(\tilde{x} \in C),
\]</span></p>
<p>donde: - <span class="math inline">\(\tilde{x}\)</span> es la muestra, - <span class="math inline">\(C\)</span> es la <strong>región crítica</strong> (el conjunto de valores de la muestra que llevan a rechazar <span class="math inline">\(H_0\)</span>).</p>
<p>En palabras:<br><strong>La función de potencia nos dice qué tan probable es rechazar <span class="math inline">\(H_0\)</span>, dado que el parámetro vale <span class="math inline">\(\theta\)</span>.</strong></p>
<hr></section><section id="casos-especiales-de-la-función-de-potencia" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="casos-especiales-de-la-función-de-potencia">
<span class="header-section-number">4.3</span> 2. Casos especiales de la función de potencia</h2>
<ul>
<li>
<p>Si <span class="math inline">\(\theta \in \Theta_0\)</span> (es decir, si <span class="math inline">\(H_0\)</span> es cierta):</p>
<p><span class="math display">\[
\eta(\theta) = \alpha
\]</span></p>
<p>Esto refleja que, bajo <span class="math inline">\(H_0\)</span>, la probabilidad de rechazar <span class="math inline">\(H_0\)</span> es justamente la probabilidad de cometer un <strong>error de tipo I</strong>.</p>
</li>
<li>
<p>Si <span class="math inline">\(\theta \in \Theta_1\)</span> (es decir, si <span class="math inline">\(H_1\)</span> es cierta):</p>
<p><span class="math display">\[
\eta(\theta) = 1 - \beta
\]</span></p>
<p>Esto refleja que, bajo <span class="math inline">\(H_1\)</span>, la probabilidad de rechazar <span class="math inline">\(H_0\)</span> es la <strong>potencia de la prueba</strong>.</p>
</li>
</ul>
<hr></section><section id="tamaño-y-nivel-de-significación" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="tamaño-y-nivel-de-significación">
<span class="header-section-number">4.4</span> 3. Tamaño y nivel de significación</h2>
<ul>
<li>
<p><strong>Tamaño <span class="math inline">\(\alpha\)</span>:</strong><br>
Una prueba tiene tamaño <span class="math inline">\(\alpha\)</span> si el peor caso (la mayor probabilidad de rechazar <span class="math inline">\(H_0\)</span> cuando es cierta) es exactamente <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
\sup_{\theta \in \Theta_0} \eta(\theta) = \alpha
\]</span></p>
<p>→ El tamaño es el “valor máximo real” de error tipo I que puede ocurrir bajo <span class="math inline">\(H_0\)</span>.</p>
</li>
<li>
<p><strong>Nivel de significación <span class="math inline">\(\alpha\)</span>:</strong><br>
Una prueba tiene nivel de significación <span class="math inline">\(\alpha\)</span> si ese peor caso <strong>no excede</strong> <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
\sup_{\theta \in \Theta_0} \eta(\theta) \leq \alpha
\]</span></p>
<p>→ El nivel de significación es un <strong>límite superior</strong> que ponemos a la probabilidad de error tipo I.</p>
</li>
</ul>
<p><strong>Nota:</strong> Todo contraste de tamaño <span class="math inline">\(\alpha\)</span> tiene también nivel de significación <span class="math inline">\(\alpha\)</span>, pero no todo contraste con nivel de significación <span class="math inline">\(\alpha\)</span> necesariamente alcanza el tamaño exacto.</p>
<hr></section><section id="contraste-más-potente" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="contraste-más-potente">
<span class="header-section-number">4.5</span> 4. Contraste más potente</h2>
<p>Entre todas las pruebas que tienen el mismo tamaño <span class="math inline">\(\alpha\)</span>, buscamos la que <strong>minimiza <span class="math inline">\(\beta\)</span></strong> (o equivalentemente, la que maximiza la potencia <span class="math inline">\(1-\beta\)</span>).</p>
<p>Esa prueba se llama:</p>
<ul>
<li>
<strong>El contraste más potente de tamaño <span class="math inline">\(\alpha\)</span></strong>,<br>
</li>
<li>o <strong>el mejor contraste de tamaño <span class="math inline">\(\alpha\)</span></strong>.</li>
</ul>
<p>Es decir, para un mismo control de error tipo I, elegimos la prueba que detecta con mayor eficacia cuando <span class="math inline">\(H_1\)</span> es verdadera.</p>
<hr>
<p><strong>En resumen:</strong><br>
- La función de potencia es la herramienta que unifica <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(1-\beta\)</span>.<br>
- Tamaño = probabilidad máxima de error tipo I.<br>
- Nivel de significación = restricción para controlar ese error.<br>
- El mejor contraste de tamaño <span class="math inline">\(\alpha\)</span> es aquel que, manteniendo fijo el error tipo I, <strong>maximiza la probabilidad de rechazar <span class="math inline">\(H_0\)</span> cuando realmente es falsa</strong>.</p>
</section>
</div>
</div>
<div id="exm-4.2" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.1 (Problema 1)</strong></span> Sea <span class="math inline">\(X \sim \mathrm{Bin}(5,\theta)\)</span>. Considere el contraste <span class="math display">\[
\begin{cases}
H_0:\ \theta \le \tfrac{1}{2},\\[2mm]
H_1:\ \theta &gt; \tfrac{1}{2}.
\end{cases}
\]</span></p>
<p>Establezca la <strong>función de potencia</strong>, gráfiquela e <strong>interprete comparativamente</strong> los resultados en las siguientes dos opciones:</p>
<ol type="a">
<li>Considere primero el contraste de <strong>rechazar <span class="math inline">\(H_0\)</span> si y sólo si</strong> se observan <strong>todos los éxitos</strong> (es decir, <span class="math inline">\(X=5\)</span>).</li>
</ol>
<p><strong>Opción (a)</strong>:</p>
<p>Rechazar <span class="math inline">\(H_0\)</span> <strong>solo si</strong> se observan los 5 éxitos</p>
<p><strong>Modelo.</strong> Sea <span class="math inline">\(X \sim \mathrm{Bin}(5,\theta)\)</span> con función de probabilidad<br><span class="math inline">\(P_\theta(X=x)=\binom{5}{x}\theta^x(1-\theta)^{5-x}\)</span>, <span class="math inline">\(x=0,1,\dots,5\)</span>.</p>
<p><strong>Región crítica</strong> La regla propuesta es <strong>rechazar</strong> <span class="math inline">\(H_0\)</span> únicamente cuando <span class="math inline">\(X=5\)</span>. Por tanto, <span class="math display">\[
C_a=\{5\},\qquad \bar C_a=\{0,1,2,3,4\}.
\]</span></p>
<p><strong>Función de potencia <span class="math inline">\(\eta_a(\theta)\)</span></strong> Por definición, la potencia es la probabilidad de caer en la región crítica: <span class="math display">\[
\eta_a(\theta)=P_\theta(X\in C_a)=P_\theta(X=5)
=\binom{5}{5}\theta^5(1-\theta)^{0}
=\theta^5.
\]</span> Es decir, <strong>para cualquier</strong> <span class="math inline">\(0\le \theta\le 1\)</span>, <span class="math display">\[
\eta_a(\theta)=\theta^5.
\]</span></p>
<p><strong>Tamaño (máximo error tipo I)</strong> El <strong>tamaño</strong> del contraste es <span class="math display">\[
\alpha_a=\sup_{\theta\in\Theta_0}\eta_a(\theta)
=\sup_{\theta\le 1/2}\theta^5.
\]</span> Como <span class="math inline">\(\theta^5\)</span> es <strong>estrictamente creciente</strong> en <span class="math inline">\(\theta\)</span> (derivada <span class="math inline">\(5\theta^4&gt;0\)</span>), el supremo en <span class="math inline">\(\Theta_0=\{\theta\le 1/2\}\)</span> se alcanza en el borde <span class="math inline">\(\theta=1/2\)</span>: <span class="math display">\[
\alpha_a=\left(\tfrac12\right)^5=\frac{1}{32}\approx 0.03125.
\]</span></p>
<p><strong>Lectura e intuición</strong> - La regla <span class="math inline">\(C_a=\{5\}\)</span> es <strong>muy conservadora</strong>: solo rechaza <span class="math inline">\(H_0\)</span> en el caso más extremo. - Por eso, el <strong>tamaño</strong> es muy pequeño (<span class="math inline">\(\alpha_a\approx 3.1\%\)</span>). - La <strong>potencia</strong> <span class="math inline">\(\eta_a(\theta)=\theta^5\)</span> crece muy lentamente; el test casi nunca rechaza salvo que <span class="math inline">\(\theta\)</span> sea <strong>muy grande</strong>.<br>
En términos del error tipo II <span class="math inline">\(\beta_a(\theta)=1-\eta_a(\theta)=1-\theta^5\)</span>: - Si <span class="math inline">\(\theta=0.6\)</span>, <span class="math inline">\(\beta_a=1-0.6^5\approx 0.922\)</span> (muy alto). - Si <span class="math inline">\(\theta=0.9\)</span>, <span class="math inline">\(\beta_a=1-0.9^5\approx 0.410\)</span>. - Recién cerca de <span class="math inline">\(\theta=0.99\)</span>, <span class="math inline">\(\beta_a\approx 0.049\)</span>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 29%">
<col style="width: 47%">
</colgroup>
<thead><tr class="header">
<th>Concepto</th>
<th>Explicación</th>
<th>Ejemplos numéricos</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<strong>Regla</strong> <span class="math inline">\(C_a = \{5\}\)</span>
</td>
<td>Muy conservadora: solo rechaza <span class="math inline">\(H_0\)</span> en el caso más extremo.</td>
<td>-</td>
</tr>
<tr class="even">
<td>
<strong>Tamaño</strong> <span class="math inline">\(\alpha_a\)</span>
</td>
<td>Muy pequeño (<span class="math inline">\(\alpha_a \approx 3.1\%\)</span>).</td>
<td>-</td>
</tr>
<tr class="odd">
<td>
<strong>Potencia</strong> <span class="math inline">\(\eta_a(\theta) = \theta^5\)</span>
</td>
<td>Crece muy lentamente; el test casi nunca rechaza salvo que <span class="math inline">\(\theta\)</span> sea muy grande.</td>
<td>-</td>
</tr>
<tr class="even">
<td>
<strong>Error tipo II</strong> <span class="math inline">\(\beta_a(\theta) = 1 - \eta_a(\theta) = 1 - \theta^5\)</span>
</td>
<td>Se mantiene alto para valores de <span class="math inline">\(\theta\)</span> moderados.</td>
<td>- Para <span class="math inline">\(\theta=0.6\)</span>: <span class="math inline">\(\beta_a = 1 - 0.6^5 \approx 0.922\)</span> (muy alto). <br> - Para <span class="math inline">\(\theta=0.9\)</span>: <span class="math inline">\(\beta_a = 1 - 0.9^5 \approx 0.410\)</span>. <br> - Para <span class="math inline">\(\theta=0.99\)</span>: <span class="math inline">\(\beta_a \approx 0.049\)</span>.</td>
</tr>
</tbody>
</table>
<p><strong>Conclusión.</strong> Es un contraste con <strong>bajo error tipo I</strong> pero <strong>muy poca potencia</strong>, salvo cuando el efecto es extremadamente grande (valores de <span class="math inline">\(\theta\)</span> muy cercanos a 1).</p>
<ol start="2" type="a">
<li>Considere en segundo lugar el contraste de <strong>rechazar <span class="math inline">\(H_0\)</span> si</strong> <span class="math inline">\(X \in \{3,4,5\}\)</span>.</li>
</ol>
<p><strong>Opción (b)</strong>:</p>
<p>Rechazar <span class="math inline">\(H_0\)</span> si <span class="math inline">\(X\in\{3,4,5\}\)</span> (equiv. <span class="math inline">\(X\ge 3\)</span>)</p>
<p><strong>Modelo.</strong> Sea <span class="math inline">\(X\sim \mathrm{Bin}(5,\theta)\)</span> con <span class="math display">\[
P_\theta(X=x)=\binom{5}{x}\,\theta^x(1-\theta)^{5-x},\quad x=0,1,\dots,5.
\]</span></p>
<p><strong>Región crítica</strong> <span class="math display">\[
C_b=\{3,4,5\},\qquad \bar C_b=\{0,1,2\}.
\]</span></p>
<p><strong>Función de potencia <span class="math inline">\(\eta_b(\theta)\)</span></strong> Por definición, la potencia es la probabilidad de caer en la región crítica: <span class="math display">\[
\eta_b(\theta)=P_\theta(X\in C_b)=P_\theta(X\ge 3)
=\sum_{k=3}^{5}\binom{5}{k}\theta^k(1-\theta)^{5-k}.
\]</span></p>
<p><strong>Suma directa.</strong> <span class="math display">\[
\eta_b(\theta)=10\,\theta^3(1-\theta)^2+5\,\theta^4(1-\theta)+\theta^5.
\]</span></p>
<p><strong>Vía complemento (útil para el tamaño).</strong> <span class="math display">\[
\eta_b(\theta)=1-P_\theta(X\le 2)
=1-\Big[(1-\theta)^5+5\theta(1-\theta)^4+10\theta^2(1-\theta)^3\Big].
\]</span></p>
<p><strong>Monotonía.</strong> Para la familia binomial, <span class="math inline">\(P_\theta(X\ge c)\)</span> es creciente en <span class="math inline">\(\theta\)</span> (propiedad MLR). Por tanto, <span class="math inline">\(\eta_b(\theta)\)</span> <strong>aumenta</strong> con <span class="math inline">\(\theta\)</span>.</p>
<p><strong>Tamaño (máximo error tipo I)</strong> El tamaño es <span class="math display">\[
\alpha_b=\sup_{\theta\le 1/2}\eta_b(\theta).
\]</span> Como <span class="math inline">\(\eta_b(\theta)\)</span> es creciente, el supremo se alcanza en el borde <span class="math inline">\(\theta=1/2\)</span>: <span class="math display">\[
\alpha_b=\eta_b(1/2)=P_{1/2}(X\ge 3)=1-P_{1/2}(X\le 2).
\]</span> Con simetría binomial: <span class="math display">\[
P_{1/2}(X\le 2)=\frac{\binom50+\binom51+\binom52}{2^5}
=\frac{1+5+10}{32}=\frac{16}{32},
\]</span> luego <span class="math display">\[
\alpha_b=1-\frac{16}{32}=\frac{16}{32}=0.5.
\]</span></p>
<p><strong>Lectura numérica (potencia y error tipo II)</strong> Valores aproximados:</p>
<p><span class="math display">\[
\begin{array}{c|ccccc}
\theta &amp; 0.55 &amp; 0.60 &amp; 0.70 &amp; 0.80 &amp; 0.90\\ \hline
\eta_b(\theta)=P_\theta(X\ge 3) &amp; 0.593 &amp; 0.683 &amp; 0.837 &amp; 0.942 &amp; 0.991\\
\beta_b(\theta)=1-\eta_b(\theta) &amp; 0.407 &amp; 0.317 &amp; 0.163 &amp; 0.058 &amp; 0.009
\end{array}
\]</span></p>
<ul>
<li>Para <span class="math inline">\(\theta&gt;1/2\)</span>, la potencia crece <strong>rápido</strong> y el error tipo II cae pronto: ya con <span class="math inline">\(\theta\approx 0.7\)</span> la potencia es alta.</li>
<li>El costo es un <strong>tamaño enorme</strong>: <span class="math inline">\(\alpha_b=0.5\)</span> (inaceptable en la práctica).</li>
</ul>
<p><strong>Observación de diseño (cómo fijar <span class="math inline">\(\alpha\)</span> razonable)</strong></p>
<p>Con <span class="math inline">\(n=5\)</span> y <span class="math inline">\(H_0:\theta\le 1/2\)</span>:</p>
<ul>
<li><p><span class="math inline">\(X\ge 5\)</span> da <span class="math inline">\(\alpha=(1/2)^5=1/32\approx 0.03125\)</span>.</p></li>
<li><p><span class="math inline">\(X\ge 4\)</span> da <span class="math inline">\(\alpha=P_{1/2}(X\ge 4)=(\binom54+\binom55)/32=(5+1)/32=6/32=0.1875\)</span>.</p></li>
<li><p>Para alcanzar, por ejemplo, <span class="math inline">\(\alpha=0.10\)</span>, sería necesario <strong>aleatorizar</strong> en <span class="math inline">\(X=4\)</span> (rechazar con cierta probabilidad cuando <span class="math inline">\(X=4\)</span>) o aumentar el tamaño muestral.</p></li>
</ul>
</div>
<hr>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.001</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eta_a</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">^</span><span class="fl">5</span></span>
<span><span class="va">eta_b</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">*</span><span class="va">theta</span><span class="op">^</span><span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">theta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">5</span><span class="op">*</span><span class="va">theta</span><span class="op">^</span><span class="fl">4</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">theta</span><span class="op">)</span> <span class="op">+</span> <span class="va">theta</span><span class="op">^</span><span class="fl">5</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">eta_a</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2</span>,</span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">eta</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Funciones de potencia: regiones críticas {5} y {3,4,5}"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">eta_b</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0.5</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">5</span>, <span class="fl">0.5</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="va">a</span><span class="op">]</span><span class="op">==</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter3_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<div id="exm-4.3" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.2 (Problema 2)</strong></span> Apoyándose en el ejercicio anterior, responda claramente a las siguientes preguntas:</p>
<p>I. A partir del contraste del inciso <strong>a</strong>, ¿es <strong>falsa o verdadera</strong> la afirmación: “La probabilidad del <strong>error tipo I</strong> es aceptablemente baja para todo <span class="math inline">\(\theta \le \tfrac{1}{2}\)</span>”? <strong>Explique su respuesta.</strong></p>
<p><strong>Sí, es verdadera.</strong><br>
Bajo <span class="math inline">\(H_0:\theta\le \tfrac12\)</span>, el error tipo I del contraste (a) es <span class="math display">\[
P_\theta(\text{rechazar }H_0)=\eta_a(\theta)=\theta^5.
\]</span> Como <span class="math inline">\(\theta^5\)</span> es creciente en <span class="math inline">\(\theta\)</span>, su máximo sobre <span class="math inline">\(\Theta_0=\{\theta\le \tfrac12\}\)</span> se alcanza en el borde: <span class="math display">\[
\alpha_a=\sup_{\theta\le 1/2}\eta_a(\theta)=\eta_a\!\left(\tfrac12\right)=\left(\tfrac12\right)^5=\frac{1}{32}\approx 0.03125.
\]</span> Por tanto, <strong>para todo</strong> <span class="math inline">\(\theta\le \tfrac12\)</span> se tiene <span class="math inline">\(\eta_a(\theta)\le 0.03125\)</span>, es decir, un nivel de error tipo I <strong>muy bajo</strong>.</p>
<ol start="2" type="I">
<li>¿Para qué valores de <span class="math inline">\(\theta\)</span> el <strong>error tipo II</strong> es <strong>menor que <span class="math inline">\(\tfrac{1}{2}\)</span></strong> en el contraste del inciso <strong>a</strong>?</li>
</ol>
<p>En (a), bajo <span class="math inline">\(H_1\)</span> el error tipo II es <span class="math display">\[
\beta_a(\theta)=1-\eta_a(\theta)=1-\theta^5.
\]</span> La condición <span class="math inline">\(\beta_a(\theta)&lt;\tfrac12\)</span> equivale a <span class="math display">\[
1-\theta^5&lt;\tfrac12\quad\Longleftrightarrow\quad \theta^5&gt;\tfrac12
\quad\Longleftrightarrow\quad \theta&gt;(1/2)^{1/5}\approx 0.87055.
\]</span> Luego, <strong>para <span class="math inline">\(\theta&gt;0.87055\)</span></strong> (y, por supuesto, <span class="math inline">\(\theta&gt;1/2\)</span>), el error tipo II es menor a <span class="math inline">\(1/2\)</span>.</p>
<ol start="3" type="I">
<li>En el contraste del inciso <strong>b</strong>, ¿para qué valores de <span class="math inline">\(\theta\)</span> el <strong>error tipo II</strong> alcanza <strong>valores pequeños</strong>?</li>
</ol>
<p>En (b), <span class="math display">\[
\beta_b(\theta)=1-\eta_b(\theta)=P_\theta(X\le 2)
=(1-\theta)^5+5\theta(1-\theta)^4+10\theta^2(1-\theta)^3,
\]</span> función <strong>decreciente</strong> en <span class="math inline">\(\theta\)</span>. Valores representativos: <span class="math display">\[
\begin{array}{c|ccccc}
\theta &amp; 0.55 &amp; 0.60 &amp; 0.70 &amp; 0.75 &amp; 0.80\\ \hline
\beta_b(\theta) &amp; 0.407 &amp; 0.317 &amp; 0.163 &amp; 0.104 &amp; 0.058
\end{array}
\]</span> Se observa que <span class="math inline">\(\beta_b(\theta)\)</span> ya es <strong>pequeña</strong> (por ejemplo <span class="math inline">\(&lt;0.10\)</span>) a partir de <strong><span class="math inline">\(\theta\gtrsim 0.78\)</span></strong> (pues en <span class="math inline">\(0.75\)</span> es <span class="math inline">\(\approx 0.104\)</span> y en <span class="math inline">\(0.80\)</span> es <span class="math inline">\(\approx 0.058\)</span>).</p>
<ol start="4" type="I">
<li>¿Es <strong>falso o verdadero</strong> afirmar que: “La <strong>potencia</strong> del contraste del inciso <strong>b</strong> es mayor que la potencia del otro contraste para valores de <span class="math inline">\(\theta \le \tfrac{1}{2}\)</span>. Entonces, la probabilidad del <strong>error tipo I</strong> del contraste del inciso <strong>b</strong> es mayor que la del <strong>otro contraste</strong> para valores de <span class="math inline">\(\theta \le \tfrac{1}{2}\)</span>”? <strong>Explique su respuesta.</strong>
</li>
</ol>
<p><strong>Verdadero.</strong><br>
Para <span class="math inline">\(\theta\le \tfrac12\)</span> (región nula):</p>
<ul>
<li><p>La “potencia” <span class="math inline">\(\eta(\theta)\)</span> coincide con la <strong>probabilidad de error tipo I en ese punto</strong>.</p></li>
<li><p>Numéricamente (y por la propiedad MLR de la binomial) se verifica que <span class="math display">\[
\eta_b(\theta)=P_\theta(X\ge 3)\;&gt;\;\eta_a(\theta)=\theta^5
\quad \text{para todo }\theta\le \tfrac12.
\]</span> Ejemplos:<br><span class="math inline">\(\theta=0.5:\ \eta_b=0.5\ \text{vs}\ \eta_a=0.03125\)</span>;<br><span class="math inline">\(\theta=0.4:\ \eta_b\approx 0.31744\ \text{vs}\ \eta_a=0.01024\)</span>.</p></li>
<li><p>En particular, el <strong>tamaño</strong> es mayor en (b):<br><span class="math display">\[
\alpha_b=\eta_b(1/2)=0.5 \quad\gg\quad \alpha_a=\eta_a(1/2)=1/32\approx 0.03125.
\]</span></p></li>
</ul>
<p><strong>Conclusión:</strong> el contraste (b) <strong>rechaza con mucha más frecuencia</strong> bajo <span class="math inline">\(H_0\)</span> (mayor error tipo I), lo que explica su mayor potencia bajo <span class="math inline">\(H_1\)</span>; el costo es un nivel <span class="math inline">\(\alpha\)</span> <strong>inaceptablemente alto</strong> en (b) comparado con (a).</p>
</div>
<p>El siguiente resultado determina cuál es el contraste más potente cuando se contrasta una hipótesis nula simple frente a una alternativa simple.</p>
</section><section id="lema-de-neyman-pearson" class="level3" data-number="4.5.1"><h3 data-number="4.5.1" class="anchored" data-anchor-id="lema-de-neyman-pearson">
<span class="header-section-number">4.5.1</span> Lema de Neyman-Pearson</h3>
<p>Sea <span class="math inline">\(X_1 ,\ldots, X_n\)</span> una muestra aleatoria simple de <span class="math inline">\(X\)</span> con función de densidad (o función de masa de probabilidad) <span class="math inline">\(f(x; \theta)\)</span>. Se desea contrastar <span class="math inline">\(H_ 0 : \theta = \theta_0\)</span> frente a <span class="math inline">\(H_1 : \theta = \theta_1\)</span> . Si <span class="math inline">\(L(\theta\mid\underset{\sim}{x})\)</span> es la función de verosimilitud, el mejor contraste de tamaño <span class="math inline">\(\alpha\)</span> tiene región crítica de la forma <span class="math display">\[C=\left\{\underset{\sim}{x}\in\mathcal{X}^n:\frac{L(\theta_1\mid\underset{\sim}{x})}{L(\theta_0\mid\underset{\sim}{x})}\geq A\right\}\]</span> para algún <span class="math inline">\(A\geq 0\)</span>.</p>
<p>El contraste que se propone en el Lema de Neyman-Pearson se denomina también <strong>test de la razón</strong> de verosimilitudes.</p>
<div id="exm-4.4" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.3</strong></span> Sea <span class="math inline">\(X_1 ,\ldots, X_n\)</span> muestra aleatoria simple de <span class="math inline">\(X\sim N(\mu, \sigma^2)\)</span> con <span class="math inline">\(\sigma^2\)</span> conocido. Se desea contrastar <span class="math inline">\(H_0 : \mu= \mu_0\)</span> frente a <span class="math inline">\(H_1: \mu = \mu_1\)</span>, con <span class="math inline">\(\mu_1 &gt; \mu_0\)</span>.</p>
</div>
<p>Nuestra intuición nos dice que se debe rechazar <span class="math inline">\(H_0\)</span> si se observan valores grandes de <span class="math inline">\(x\)</span>. Veamos que la aplicación del Lema de Neyman-Pearson conduce a esta solución.</p>
<div id="exm-4.4" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.4 (Ejemplo anterior)</strong></span> <strong>Test Z unilateral por Neyman–Pearson (varianza conocida)</strong></p>
<p>Sea <span class="math inline">\(X_1,\ldots,X_n\)</span> una muestra aleatoria simple de <span class="math inline">\(X\sim N(\mu,\sigma^2)\)</span> con <span class="math inline">\(\sigma^2\)</span> <strong>conocida</strong>.<br>
Se desea contrastar <span class="math display">\[
H_0:\ \mu=\mu_0
\qquad\text{frente a}\qquad
H_1:\ \mu=\mu_1,\ \ \mu_1&gt;\mu_0.
\]</span></p>
<p>La intuición sugiere <strong>rechazar <span class="math inline">\(H_0\)</span></strong> cuando la media muestral <span class="math inline">\(\bar X\)</span> tome <strong>valores grandes</strong>.<br>
Veremos que el <strong>Lema de Neyman–Pearson</strong> conduce exactamente a esta regla.</p>
<hr>
<p><strong>Verosimilitud y cociente de verosimilitudes</strong></p>
<p>La verosimilitud de una muestra <span class="math inline">\(x=(x_1,\dots,x_n)\)</span> es <span class="math display">\[
L(\mu\mid x)=(2\pi\sigma^2)^{-n/2}\exp\!\left\{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x_i-\mu)^2\right\}.
\]</span></p>
<p>El <strong>cociente de verosimilitudes</strong> (likelihood ratio) es <span class="math display">\[
\frac{L(\mu_1\mid x)}{L(\mu_0\mid x)}
=\exp\!\left\{\frac{1}{2\sigma^2}\sum_{i=1}^n\Big[(x_i-\mu_0)^2-(x_i-\mu_1)^2\Big]\right\}.
\]</span></p>
<p>Notemos que <span class="math display">\[
(x_i-\mu_0)^2-(x_i-\mu_1)^2
=2x_i(\mu_1-\mu_0)+(\mu_0^2-\mu_1^2),
\]</span> de modo que, al sumar y usar <span class="math inline">\(\bar x=\tfrac{1}{n}\sum x_i\)</span>, <span class="math display">\[
\frac{L(\mu_1\mid x)}{L(\mu_0\mid x)}
=\exp\!\left\{\frac{n}{2\sigma^2}\Big(2\bar x(\mu_1-\mu_0)+(\mu_0^2-\mu_1^2)\Big)\right\}.
\]</span></p>
<p>Por el Lema de Neyman–Pearson, la región crítica óptima (para tamaño dado) es del tipo <span class="math display">\[
C=\Big\{x:\ \frac{L(\mu_1\mid x)}{L(\mu_0\mid x)}\ge A\Big\}
=\left\{x:\ \exp\!\left\{\frac{n}{2\sigma^2}\Big(2\bar x(\mu_1-\mu_0)+(\mu_0^2-\mu_1^2)\Big)\right\}\ge A\right\}.
\]</span></p>
<p>Como <span class="math inline">\(\mu_1-\mu_0&gt;0\)</span>, el cociente es <strong>función creciente de <span class="math inline">\(\bar x\)</span></strong>. Por tanto, la región crítica puede escribirse como <span class="math display">\[
C=\{x:\ \bar x\ge B\}.
\]</span></p>
<p>Las constantes <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> se relacionan por <span class="math display">\[
B=\frac{\sigma^2\log A}{n(\mu_1-\mu_0)}+\frac{\mu_1+\mu_0}{2}.
\]</span></p>
<hr>
<p><strong>Fijar el tamaño <span class="math inline">\(\alpha\)</span> y obtener <span class="math inline">\(B\)</span></strong></p>
<p>No es necesario hallar <span class="math inline">\(B\)</span> a partir de <span class="math inline">\(A\)</span>. Basta imponer el tamaño deseado: <span class="math display">\[
P(C\mid H_0)=P(\bar X\ge B\mid H_0)=\alpha.
\]</span> Bajo <span class="math inline">\(H_0\)</span>, <span class="math inline">\(\bar X\sim N(\mu_0,\sigma^2/n)\)</span>, así que <span class="math display">\[
B=\mu_0+z_\alpha\,\frac{\sigma}{\sqrt{n}},
\]</span> donde <span class="math inline">\(z_\alpha\)</span> satisface <span class="math inline">\(P(Z\ge z_\alpha)=\alpha\)</span> para <span class="math inline">\(Z\sim N(0,1)\)</span>.</p>
<p>La regla de decisión equivalente es: <span class="math display">\[
\text{Rechazar }H_0\ \ \Longleftrightarrow\ \ Z=\frac{\bar X-\mu_0}{\sigma/\sqrt{n}}\ge z_\alpha.
\]</span></p>
<hr>
<p><strong>Ejemplo numérico</strong></p>
<p>Supongamos <span class="math inline">\(\mu_0=5\)</span>, <span class="math inline">\(\mu_1=6\)</span>, <span class="math inline">\(\sigma^2=1\)</span> (luego <span class="math inline">\(\sigma=1\)</span>), <span class="math inline">\(\alpha=0.05\)</span> y <span class="math inline">\(n=4\)</span>.</p>
<ol type="1">
<li><p><strong>Umbral crítico para <span class="math inline">\(\bar X\)</span>:</strong> <span class="math display">\[
B=\mu_0+z_{0.05}\frac{\sigma}{\sqrt{n}}
=5+1.645\cdot\frac{1}{2}
=5+0.8225
=5.8225.
\]</span></p></li>
<li><p><strong>Regla equivalente con <span class="math inline">\(Z\)</span>:</strong> <span class="math display">\[
Z=\frac{\bar X-5}{1/\sqrt{4}}
=\frac{\bar X-5}{0.5}
\ge 1.645.
\]</span></p></li>
<li><p><strong>Datos observados:</strong> <span class="math inline">\(x=(5.1,\,5.5,\,4.9,\,5.3)\)</span>.<br>
Media muestral: <span class="math inline">\(\bar x=\tfrac{5.1+5.5+4.9+5.3}{4}=5.2\)</span>.</p></li>
<li><p><strong>Cálculo del estadístico:</strong> <span class="math display">\[
z=\frac{\bar x-5}{1/\sqrt{4}}=\frac{5.2-5}{0.5}=0.4&lt;1.645.
\]</span></p></li>
</ol>
<p><strong>Decisión:</strong> no se rechaza <span class="math inline">\(H_0\)</span> al nivel <span class="math inline">\(\alpha=0.05\)</span>.</p>
<hr>
<p><strong>Comentario final</strong></p>
<p>Este contraste se denomina <strong>test Z unilateral</strong> porque usa el estadístico <span class="math display">\[
Z=\sqrt{n}\,\frac{\bar X-\mu_0}{\sigma}\ \sim\ N(0,1)\ \ \text{bajo }H_0.
\]</span></p>
</div>
<div id="tip-4.1" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;4.3: Conclusiones de un contraste: el p-valor.
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>Una forma de informar de los resultados de un contraste de hipótesis es mediante el tamaño <span class="math inline">\(\alpha\)</span> del test usado y la decisión tomada sobre si se rechazó o no <span class="math inline">\(H_0\)</span>.</li>
<li>Si <span class="math inline">\(\alpha\)</span> es pequeño la decisión de rechazar <span class="math inline">\(H_0\)</span> es muy convincente, pero si <span class="math inline">\(\alpha\)</span> es grande la probabilidad de cometer un error de tipo I es grande, lo cuál resta fuerza al test si la decisión adoptada es la de rechazar <span class="math inline">\(H_0\)</span>.</li>
<li>Por otro lado, para <span class="math inline">\(\alpha\)</span> muy pequeño, el hecho de no rechazar <span class="math inline">\(H_0\)</span> no se interpretará como un apoyo indiscutible a esta hipótesis sino como que no fue posible encontrar evidencia suficiente en su contra como para superar la barrera tan restrictiva impuesta por ese valor de <span class="math inline">\(\alpha\)</span>.</li>
</ol>
</div>
</div>
<div id="def-4.1" class="definition theorem">
<p><span class="theorem-title"><strong>Definition 4.2</strong></span> Una forma alternativa de presentar los resultados de un contraste de hipótesis es dar el p-valor o valor de probabilidad del test, definido éste como el supremo de los valores <span class="math inline">\(\alpha\)</span> para los cuáles se rechazaría la hipótesis nula si ésta se contrastase a nivel <span class="math inline">\(\alpha\)</span>.</p>
</div>
<p>El p-valor depende de los datos muestrales. Puede interpretarse como la probabilidad de observar otra muestra que sea al menos tan poco favorable a la hipótesis nula como la que se ha observado.</p>
<p>A partir del p-valor se puede tomar la decisión de rechazar (respectivamente, aceptar) <span class="math inline">\(H_0\)</span> si el p-valor es pequeño (respectivamente, grande).</p>
<p>Por ejemplo, el p-valor de un contraste dado por el Lema de Neyman-Pearson es: <span class="math display">\[p=P_{\theta_0}\left\{\frac{L(\theta_1\mid\underset{\sim}{X})}{L(\theta_0\mid\underset{\sim}{X})}\geq \frac{L(\theta_1\mid\underset{\sim}{x})}{L(\theta_0\mid\underset{\sim}{x})}\right\}\]</span> En general, cuando la región crítica de un contraste de tamaño <span class="math inline">\(\alpha\)</span> es tal que se rechaza <span class="math inline">\(H_0\)</span> si y sólo si <span class="math inline">\(W(\underset{\sim}{x})\geq c_\alpha\)</span>, donde <span class="math inline">\(W(\underset{\sim}{x})\)</span> es un estadístico y <span class="math inline">\(c_\alpha\)</span> se elige para que el test tenga tamaño <span class="math inline">\(\alpha\)</span>, entonces el p-valor del contraste para una muestra observada <span class="math inline">\(\underset{\sim}{x}\)</span> es <span class="math display">\[p(\underset{\sim}{x})=\sup_{\theta\in\Theta_0}P_{\theta_0}\{W(\underset{\sim}{X})\geq W(\underset{\sim}{x})\}\]</span></p>
</section></section><section id="contrastes-uniformemente-más-potentes" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="contrastes-uniformemente-más-potentes">
<span class="header-section-number">4.6</span> Contrastes uniformemente más potentes</h2>
<p>Nos ocuparemos ahora de los contrastes de hipótesis en los que la hipótesis alternativa es compuesta. Queremos contrastar.</p>
<p><span class="math display">\[\left\{ \begin{array}{lcc}
    H_0 &amp;   :  &amp; \theta \in\Theta_0 \\
    \\ H_1 &amp;  : &amp; \theta \in\Theta_1  
    \end{array}
    \right.\]</span></p>
<p>donde <span class="math inline">\(\Theta_0\cup\Theta_1=\Theta\)</span>, <span class="math inline">\(\Theta_0\cap\Theta_1=\emptyset\)</span></p>
<div id="exm-4.4" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.5</strong></span> Por ejemplo, si <span class="math inline">\(\Theta=[0,\infty)\)</span> podemos contrastar <span class="math display">\[\left\{ \begin{array}{lcc}
H_0 &amp;   :  &amp; \theta=\theta_0 \\
\\ H_1 &amp;  : &amp; \theta&gt;\theta_1  
\end{array}
\right.\]</span> diremos que se trata de un contraste <strong>unilateral</strong>.</p>
</div>
<div id="exm-4.5" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.6</strong></span> Por ejemplo, si <span class="math inline">\(\Theta=\mathbb{R}\)</span>, podemos contrastar</p>
<p><span class="math display">\[\left\{ \begin{array}{lcc}
        H_0 &amp;   :  &amp; \theta\leq\theta_0 \\
        \\ H_1 &amp;  : &amp; \theta&gt;\theta_0  
        \end{array}
        \right.\]</span></p>
<p><span class="math display">\[\left\{ \begin{array}{lcc}
        H_0 &amp;   :  &amp; \theta\geq\theta_0 \\
        \\ H_1 &amp;  : &amp; \theta&lt;\theta_0  
        \end{array}
        \right.\]</span></p>
<p>diremos que se trata de un contraste <strong>unilateral</strong>.</p>
</div>
<div id="exm-4.6" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.7</strong></span> Por ejemplo, si <span class="math inline">\(\Theta=[0,\infty)\)</span> podemos contrastar <span class="math display">\[\left\{ \begin{array}{lcc}
        H_0 &amp;   :  &amp; \theta=\theta_0 \\
        \\ H_1 &amp;  : &amp; \theta\neq\theta_0  
        \end{array}
        \right.\]</span> diremos que se trata de un contraste <strong>bilateral</strong>.</p>
</div>
<div id="def-4.2" class="definition theorem">
<p><span class="theorem-title"><strong>Definition 4.3</strong></span> Diremos que un contraste de hipótesis es <strong>Uniformemente más potente (UMP)</strong> para contrastar <span class="math inline">\(H_0:\theta\in\Theta_0\)</span> frente <span class="math inline">\(H_1:\theta\in\Theta_1\)</span> si su función de potencia <span class="math inline">\(\eta(\theta)\)</span> verifica que <span class="math display">\[\sup_{\theta\in\Theta_0}\eta(\theta)=\alpha\]</span> y para cualquier otro contraste con función de potencia <span class="math inline">\(\eta^*\)</span> que sea también de tamaño <span class="math inline">\(\alpha\)</span>, es decir, que cumpla <span class="math display">\[\sup_{\theta\in\Theta_0}\eta^*(\theta)=\alpha\]</span> se tiene que <span class="math display">\[\eta(\theta)\geq\eta^*(\theta),\forall\theta\in\Theta_1.\]</span></p>
</div>
<div id="tip-4.4" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;4.4: Test Uniformemente Más Potente (UMP)
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Definición</strong> - La <strong>función de potencia</strong> de un test con región crítica <span class="math inline">\(C\)</span> es:</p>
<p><span class="math display">\[
  \eta(\theta) = P_\theta(X \in C)
  \]</span></p>
<ul>
<li>
<p>Un test es <strong>UMP de tamaño <span class="math inline">\(\alpha\)</span></strong> para <span class="math inline">\(H_0:\theta \in \Theta_0\)</span> vs <span class="math inline">\(H_1:\theta \in \Theta_1\)</span> si:</p>
<p><span class="math display">\[
\sup_{\theta \in \Theta_0} \eta(\theta) = \alpha
\]</span></p>
<p>y, para cualquier otro test del mismo tamaño con función de potencia <span class="math inline">\(\eta^*(\theta)\)</span>,</p>
<p><span class="math display">\[
\eta(\theta) \geq \eta^*(\theta), \quad \forall \theta \in \Theta_1
\]</span></p>
</li>
</ul>
<p><strong>Lectura intuitiva</strong> - <strong>Mismo control de falsos positivos</strong>: todos los tests comparados tienen el mismo tamaño <span class="math inline">\(\alpha\)</span>.<br>
- <strong>Mejor detección bajo la alternativa</strong>: en todo <span class="math inline">\(\Theta_1\)</span>, la probabilidad de rechazar <span class="math inline">\(H_0\)</span> es al menos tan grande como la de cualquier otro test del mismo tamaño.</p>
<p><strong>Observaciones</strong> - A veces no existe un UMP (por ejemplo, en muchas alternativas bilaterales).<br>
- Sí existe UMP en varios problemas unilaterales cuando la familia tiene <strong>razón de verosimilitudes monótona</strong> (teorema de Karlin–Rubin).</p>
<p><strong>Mini-ejemplo (binomial unilateral)</strong> - Modelo: <span class="math inline">\(X \sim \text{Bin}(n,p)\)</span>.<br>
- Contraste: <span class="math inline">\(H_0: p \le p_0\)</span> vs <span class="math inline">\(H_1: p &gt; p_0\)</span>.<br>
- Región crítica de tamaño <span class="math inline">\(\alpha\)</span>: <span class="math inline">\(C = \{x : x \ge c_\alpha\}\)</span> donde</p>
<p><span class="math display">\[
  \alpha = P_{p_0}(X \ge c_\alpha)
  \]</span></p>
<ul>
<li>
<p>Potencia para cualquier <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
\eta(p) = P_p(X \ge c_\alpha) = \sum_{k=c_\alpha}^n \binom{n}{k} p^k (1-p)^{n-k}
\]</span></p>
</li>
</ul>
<p>Este test es <strong>UMP de tamaño <span class="math inline">\(\alpha\)</span></strong> para <span class="math inline">\(H_1: p &gt; p_0\)</span>.</p>
<p><strong>Comparación: Test cualquiera vs.&nbsp;Test UMP</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 39%">
<col style="width: 23%">
</colgroup>
<thead><tr class="header">
<th>Característica</th>
<th>Test cualquiera</th>
<th>Test UMP</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<strong>Tamaño</strong> (error Tipo I)</td>
<td>Controlado a nivel <span class="math inline">\(\alpha\)</span>
</td>
<td>Controlado a nivel <span class="math inline">\(\alpha\)</span>
</td>
</tr>
<tr class="even">
<td><strong>Potencia en algunos <span class="math inline">\(\theta \in \Theta_1\)</span></strong></td>
<td>Puede ser alta o baja, dependiendo del valor de <span class="math inline">\(\theta\)</span>
</td>
<td>Siempre es <strong>mayor o igual</strong> que la de cualquier otro test del mismo tamaño</td>
</tr>
<tr class="odd">
<td><strong>Comportamiento global</strong></td>
<td>Puede ser mejor en unos valores de <span class="math inline">\(\theta\)</span> y peor en otros</td>
<td>Es el <strong>mejor en todos los valores de <span class="math inline">\(\theta \in \Theta_1\)</span></strong>
</td>
</tr>
<tr class="even">
<td><strong>Analogía</strong></td>
<td>Un detector que funciona bien en ciertos ángulos pero falla en otros</td>
<td>Un detector que funciona <strong>igual o mejor en todos los ángulos</strong>
</td>
</tr>
<tr class="odd">
<td><strong>Existencia</strong></td>
<td>Siempre existe un test de tamaño <span class="math inline">\(\alpha\)</span>, pero no siempre es el mejor</td>
<td>No siempre existe un UMP; cuando existe, es la opción óptima</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># --- Curvas de potencia (Binomial) UMP vs. otros tests del mismo tamaño ---</span></span>
<span></span>
<span><span class="co"># Parámetros del problema</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">0.30</span></span>
<span><span class="va">alpha_target</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="co"># Función: cola superior P(X &gt;= c) para Binomial(n, p)</span></span>
<span><span class="va">binom_tail_ge</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">c</span>, <span class="va">p</span><span class="op">)</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="va">c</span> <span class="op">-</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">n</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1) UMP: región crítica de cola superior {k &gt;= c_alpha} con tamaño ≈ alpha_target</span></span>
<span><span class="va">candidates</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">n</span></span>
<span><span class="va">tails</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">candidates</span>, <span class="kw">function</span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="fu">binom_tail_ge</span><span class="op">(</span><span class="va">n</span>, <span class="va">c</span>, <span class="va">p0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Elegimos el menor c tal que P_{p0}(X &gt;= c) &lt;= alpha_target</span></span>
<span><span class="va">c_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">tails</span> <span class="op">&lt;=</span> <span class="va">alpha_target</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">c_alpha</span><span class="op">)</span><span class="op">)</span> <span class="va">c_alpha</span> <span class="op">&lt;-</span> <span class="va">n</span>  <span class="co"># por si la discretud no permite bajar de alpha</span></span>
<span></span>
<span><span class="va">R_UMP</span> <span class="op">&lt;-</span> <span class="va">c_alpha</span><span class="op">:</span><span class="va">n</span></span>
<span><span class="va">size_UMP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">R_UMP</span>, <span class="va">n</span>, <span class="va">p0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2) Test A: empezamos más conservador (c_alpha+1) y agregamos un punto interior</span></span>
<span><span class="va">R_A</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">c_alpha</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n</span></span>
<span><span class="va">size_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">R_A</span>, <span class="va">n</span>, <span class="va">p0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apuntamos a un punto interior cerca de la moda ~ n*p0</span></span>
<span><span class="va">mode_approx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p0</span><span class="op">)</span></span>
<span><span class="va">k_star_candidates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">mode_approx</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mode_approx</span> <span class="op">+</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">best_k</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">best_diff</span> <span class="op">&lt;-</span> <span class="cn">Inf</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="va">k_star_candidates</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">k</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">R_A</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">size_A</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">n</span>, <span class="va">p0</span><span class="op">)</span></span>
<span>    <span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">alpha_target</span> <span class="op">-</span> <span class="va">trial</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">diff</span> <span class="op">&lt;</span> <span class="va">best_diff</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">best_diff</span> <span class="op">&lt;-</span> <span class="va">diff</span></span>
<span>      <span class="va">best_k</span> <span class="op">&lt;-</span> <span class="va">k</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">best_k</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">R_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">R_A</span>, <span class="va">best_k</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">size_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">R_A</span>, <span class="va">n</span>, <span class="va">p0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># 3) Test B: aún más conservador (c_alpha+2) y agregamos dos puntos interiores</span></span>
<span><span class="va">R_B</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">c_alpha</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="va">n</span></span>
<span><span class="va">size_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">R_B</span>, <span class="va">n</span>, <span class="va">p0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">k_cand_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mode_approx</span> <span class="op">-</span> <span class="fl">3</span>, <span class="va">mode_approx</span> <span class="op">+</span> <span class="fl">3</span>,</span>
<span>              <span class="va">mode_approx</span> <span class="op">-</span> <span class="fl">4</span>, <span class="va">mode_approx</span> <span class="op">+</span> <span class="fl">4</span>,</span>
<span>              <span class="va">mode_approx</span> <span class="op">-</span> <span class="fl">2</span>, <span class="va">mode_approx</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="va">k_cand_B</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">k</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">k</span> <span class="op">&lt;=</span> <span class="va">n</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="op">(</span><span class="va">k</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">R_B</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">size_B</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">n</span>, <span class="va">p0</span><span class="op">)</span></span>
<span>    <span class="co"># Permitimos leve sobrepaso por discretud</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">trial</span> <span class="op">&lt;=</span> <span class="va">alpha_target</span> <span class="op">||</span> <span class="op">(</span><span class="va">trial</span> <span class="op">-</span> <span class="va">alpha_target</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.005</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">R_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">R_B</span>, <span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">size_B</span> <span class="op">&lt;-</span> <span class="va">trial</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">size_B</span> <span class="op">&gt;=</span> <span class="va">alpha_target</span> <span class="op">-</span> <span class="fl">1e-6</span><span class="op">)</span> <span class="kw">break</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Si quedó muy por debajo, añadimos el k que mejor aproxime alpha</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">size_B</span> <span class="op">&lt;</span> <span class="va">alpha_target</span> <span class="op">-</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">n</span>, <span class="va">R_B</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">alpha_target</span> <span class="op">-</span> <span class="op">(</span><span class="va">size_B</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">n</span>, <span class="va">p0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">add_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">n</span>, <span class="va">R_B</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">R_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">R_B</span>, <span class="va">add_k</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">size_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">R_B</span>, <span class="va">n</span>, <span class="va">p0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># --- Curvas de potencia ---</span></span>
<span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">p0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">power_UMP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">ps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">R_UMP</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">power_A</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">ps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">R_A</span>,   <span class="va">n</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">power_B</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">ps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">R_B</span>,   <span class="va">n</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data frame para graficar</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">ps</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  potencia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">power_UMP</span>, <span class="va">power_A</span>, <span class="va">power_B</span><span class="op">)</span>,</span>
<span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"UMP (k ≥ %d), tamaño≈%.3f"</span>, <span class="va">c_alpha</span>, <span class="va">size_UMP</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Test A (tamaño≈%.3f)"</span>, <span class="va">size_A</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Test B (tamaño≈%.3f)"</span>, <span class="va">size_B</span><span class="op">)</span></span>
<span>  <span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Gráfico con ggplot2 ---</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">p</span>, y <span class="op">=</span> <span class="va">potencia</span>, linetype <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">p0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Curvas de potencia (Binomial n=%d, H0: p ≤ p0, p0=%.2f)"</span>, <span class="va">n</span>, <span class="va">p0</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Potencia  η(p) = P_p(rechazar H0)"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter3_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Guardar PNG</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"power_curves_UMP_vs_others.png"</span>, <span class="va">g</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Archivo guardado: power_curves_UMP_vs_others.png\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Archivo guardado: power_curves_UMP_vs_others.png</code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># --- Opcional: mostrar las regiones críticas resultantes ---</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Región crítica UMP: {"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">R_UMP</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"}\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Región crítica UMP: {13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25}</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Región crítica Test A: {"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">R_A</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"}\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Región crítica Test A: {11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25}</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Región crítica Test B: {"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">R_B</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"}\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Región crítica Test B: {3, 12, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25}</code></pre>
</div>
</div>
<section id="razón-de-verosimilitud-monótona.-teorema-de-karlin-rubin." class="level3" data-number="4.6.1"><h3 data-number="4.6.1" class="anchored" data-anchor-id="razón-de-verosimilitud-monótona.-teorema-de-karlin-rubin.">
<span class="header-section-number">4.6.1</span> Razón de verosimilitud monótona. Teorema de Karlin-Rubin.</h3>
<ol type="a">
<li>En esta sección veremos que bajo determinadas condiciones es posible encontrar tests UMP para contrastes unilaterales cuyas regiones críticas son fácilmente expresables en función de un estadístico suficiente.</li>
<li>Las condiciones necesarias hacen referencia a la monotonía de la razón de verosimilitudes como función del estadístico suficiente.</li>
<li>Una familia de funciones de densidad o de probabilidad <span class="math inline">\(\{g(t\mid\theta) : \theta \in \Theta\}\)</span> para una variable aleatoria <span class="math inline">\(T\)</span> tiene <strong>razón de verosimilitudes monótona (RVM)</strong> si para cada <span class="math inline">\(\theta_2 &gt; \theta_1\)</span> el cociente <span class="math inline">\(g(t\mid\theta_2)/g(t\mid\theta_1)\)</span> es una función no decreciente de <span class="math inline">\(t\)</span> para los valores t tales que <span class="math inline">\(g(t\mid\theta_2) &gt; 0\)</span> o <span class="math inline">\(g(t\mid\theta_1) &gt; 0\)</span>.</li>
</ol>
<div id="thm-4.1" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.1</strong></span> Se desea contrastar <span class="math inline">\(H_0: \theta\leq \theta_0\)</span> frente a <span class="math inline">\(H_1: \theta &gt; \theta_0\)</span> . Supongamos que <span class="math inline">\(T\)</span> es un estadístico suficiente para <span class="math inline">\(\theta\)</span> y que la familia <span class="math inline">\(\{g(t\mid\theta): \theta \in \Theta\}\)</span> de funciones de densidad de <span class="math inline">\(T\)</span> tiene RVM. Entonces para cada <span class="math inline">\(t_0\)</span> el test que rechaza <span class="math inline">\(H_0\)</span> si y sólo si <span class="math inline">\(T&gt;t_0\)</span> es UMP de tamaño <span class="math inline">\(\alpha = P_{\theta_0}(T&gt;t_0 )\)</span>.</p>
</div>
<div id="exm-4.7" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.8</strong></span> Sea <span class="math inline">\(X_1 ,\ldots, X_n\)</span> muestra aleatoria simple de <span class="math inline">\(X\sim N(\mu,\sigma^2)\)</span> con <span class="math inline">\(\sigma^2\)</span> conocido. Se desea contrastar <span class="math inline">\(H_0:\mu = \mu_0\)</span> frente a <span class="math inline">\(H_1 : \mu\neq\mu_0\)</span></p>
</div>
<p>Para contrastar <span class="math inline">\(H_0\)</span> frente a <span class="math inline">\(H_1\)</span> parece razonable rechazar <span class="math inline">\(H_0\)</span> si se observan valores de la media muestral mucho mayores o mucho menores que <span class="math inline">\(µ_0\)</span>:</p>
<p><span class="math display">\[C=\{\underset{\sim}{x}:\bar{x}_n\leq A_1 o \bar{x}_n\geq A_2\}\]</span> donde <span class="math inline">\(A_1\)</span> y <span class="math inline">\(A_2\)</span> se eligen para que el test tenga tamaño <span class="math inline">\(\alpha\)</span>: <span class="math display">\[\begin{align}
\alpha&amp;=P(C\mid H_0)\\
      &amp;=P(\bar{x}_n\leq A_1 o \bar{x}_n\geq A_2\mid \mu=\mu0)\\
\end{align}\]</span> <span class="math display">\[\begin{align}
\alpha&amp;=P(\bar{x}_n\leq A_1 o \bar{x}_n\geq A_2\mid \mu=\mu_0)\\
      &amp;=P(\bar{x}_n\leq A_1\mid \mu=\mu_0) + P(\bar{x}_n\geq A_2\mid \mu=\mu_0)
\end{align}\]</span> La forma de fijar <span class="math inline">\(A_1\)</span> y <span class="math inline">\(A_2\)</span> puede atender a distintos criterios. Una posibilidad es elegir <span class="math inline">\(A_1\)</span> y <span class="math inline">\(A_2\)</span> de forma que <span class="math display">\[P(\bar{x}_n\leq A_1\mid \mu=\mu_0)= P(\bar{x}_n\geq A_2\mid \mu=\mu_0)=\frac{\alpha}{2}\]</span></p>
<p>es decir, <span class="math inline">\(A_1=\mu_0-\frac{z_{\frac{\alpha}{2}}\sigma}{\sqrt{n}}\)</span>, <span class="math inline">\(A_2=\mu_0+\frac{z_{\frac{\alpha}{2}}\sigma}{\sqrt{n}}\)</span></p>
<p>Entonces se rechazará <span class="math inline">\(H_0\)</span> si</p>
<p><span class="math display">\[
\left| \overline{X}_n - \mu_0 \right| \geq z_{\alpha/2} \, \frac{\sigma}{\sqrt{n}}.
\]</span></p>
<p>La función de potencia es tal como se refleja en la figura siguiente (curva de trazo continuo).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><figcaption>Gráfico de la función potencia</figcaption><p><img src="images/funcionpotencia.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Este contraste no es UMP porque, por ejemplo, si rechazamos <span class="math inline">\(H_0\)</span> cuando <span class="math inline">\(\bar{X}_n\geq\mu_0+\frac{z_\alpha´\sigma}{\sqrt{n}}\)</span> este contraste tiene potencia superior para <span class="math inline">\(\mu &gt; \mu_0\)</span> , como puede verse en la figura anterior (curva de trazo discontinuo).</p>
<div id="tip-4.5" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;4.5: Teorema de Karlin–Rubin aplicado al caso normal
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Planteamiento</strong> - Muestra i.i.d. <span class="math inline">\(X_1,\dots,X_n \sim N(\mu,\sigma^2)\)</span> con <span class="math inline">\(\sigma^2\)</span> <strong>conocida</strong>.<br>
- Estadístico: <span class="math inline">\(\overline{X}_n\)</span>.<br>
- Queremos contrastar, por ejemplo:</p>
<p><span class="math display">\[
  H_0:\ \mu \le \mu_0 \quad \text{vs} \quad H_1:\ \mu &gt; \mu_0
  \]</span></p>
<p><strong>Verificación de las hipótesis del teorema</strong> 1. <strong>Suficiencia:</strong> para varianza conocida, <span class="math inline">\(\overline{X}_n\)</span> es suficiente para <span class="math inline">\(\mu\)</span>.<br>
2. <strong>Razón de verosimilitudes monótona (RVM):</strong> la familia <span class="math inline">\(\{N(\mu,\sigma^2/n): \mu \in \mathbb{R}\}\)</span> posee RVM en <span class="math inline">\(\overline{X}_n\)</span>, porque para <span class="math inline">\(\mu_1&gt;\mu_0\)</span> la razón</p>
<p><span class="math display">\[
   \frac{f_{\mu_1}(\overline{x})}{f_{\mu_0}(\overline{x})}
   \]</span></p>
<p>es creciente en <span class="math inline">\(\overline{x}\)</span>.</p>
<p>Por el teorema, <strong>existe un test UMP de tamaño <span class="math inline">\(\alpha\)</span></strong> cuya región crítica es de cola superior.</p>
<p><strong>Test UMP (unilateral a la derecha)</strong> - Bajo <span class="math inline">\(\mu=\mu_0\)</span>:</p>
<p><span class="math display">\[
  Z=\frac{\overline{X}_n-\mu_0}{\sigma/\sqrt{n}} \sim N(0,1)
  \]</span></p>
<ul>
<li>
<p>El test UMP de tamaño <span class="math inline">\(\alpha\)</span> rechaza <span class="math inline">\(H_0\)</span> si:</p>
<p><span class="math display">\[
\overline{X}_n &gt; \mu_0 + z_{1-\alpha}\,\frac{\sigma}{\sqrt{n}}
\quad \Longleftrightarrow \quad
Z &gt; z_{1-\alpha}
\]</span></p>
</li>
<li><p><strong>Función de potencia</strong>: Como <span class="math inline">\(\overline{X}_n \sim N(\mu,\ \sigma^2/n)\)</span>, podemos escribir:</p></li>
</ul>
<p><span class="math display">\[
\overline{X}_n = \mu + \frac{\sigma}{\sqrt{n}}\,W,
\]</span></p>
<p>donde <span class="math inline">\(W \sim N(0,1)\)</span>.</p>
<p>Sustituyendo en la definición de <span class="math inline">\(Z\)</span>:</p>
<p><span class="math display">\[
Z = \frac{\mu + \tfrac{\sigma}{\sqrt{n}}W - \mu_0}{\sigma/\sqrt{n}}
= \frac{\mu-\mu_0}{\sigma/\sqrt{n}} + W.
\]</span></p>
<p>Por lo tanto:</p>
<p><span class="math display">\[
Z \sim N\!\left(\frac{\sqrt{n}}{\sigma}(\mu-\mu_0),\,1\right).
\]</span></p>
<p>Es decir: - <strong>Media:</strong> <span class="math inline">\(\delta = \tfrac{\sqrt{n}}{\sigma}(\mu-\mu_0)\)</span><br>
- <strong>Varianza:</strong> <span class="math inline">\(1\)</span></p>
<p>El estadístico de prueba es:</p>
<p><span class="math display">\[
Z = \frac{\overline{X}_n - \mu_0}{\sigma/\sqrt{n}}
\]</span></p>
<p>y bajo el verdadero valor de <span class="math inline">\(\mu\)</span> se distribuye como:</p>
<p><span class="math display">\[
Z \sim N\!\left(\frac{\sqrt{n}}{\sigma}(\mu-\mu_0),\,1\right).
\]</span></p>
<p>Es decir, <strong>una normal con media desplazada</strong>: - Media: <span class="math inline">\(\delta = \tfrac{\sqrt{n}}{\sigma}(\mu-\mu_0)\)</span><br>
- Varianza: <span class="math inline">\(1\)</span></p>
<p><span class="math display">\[
\eta(\mu) = P_\mu(\text{rechazar } H_0)
= P_\mu(Z &gt; z_{1-\alpha}).
\]</span></p>
<p><span class="math display">\[
\eta(\mu) = P\!\left(Z &gt; z_{1-\alpha}\right).
\]</span></p>
<p>Estandarizando:</p>
<p><span class="math display">\[
\eta(\mu) = P\!\left(
\frac{Z - \tfrac{\sqrt{n}}{\sigma}(\mu-\mu_0)}{1} &gt;
z_{1-\alpha} - \frac{\sqrt{n}}{\sigma}(\mu-\mu_0)
\right).
\]</span> <span class="math display">\[
  \eta(\mu)=1-\Phi\!\left(z_{1-\alpha}-\frac{\sqrt{n}}{\sigma}(\mu-\mu_0)\right)
  \]</span></p>
<p><strong>Versión unilateral a la izquierda</strong> Para <span class="math inline">\(H_0:\mu\ge\mu_0\)</span> vs <span class="math inline">\(H_1:\mu&lt;\mu_0\)</span>, el test UMP es:</p>
<p><span class="math display">\[
\text{Rechazar }H_0 \text{ si } \overline{X}_n &lt; \mu_0 - z_{1-\alpha}\,\frac{\sigma}{\sqrt{n}}
\]</span></p>
<p>con potencia</p>
<p><span class="math display">\[
\eta(\mu)=\Phi\!\left(-z_{1-\alpha}+\frac{\sqrt{n}}{\sigma}(\mu-\mu_0)\right)
\]</span></p>
<p><strong>Caso bilateral</strong> El ejemplo plantea <span class="math inline">\(H_0:\mu=\mu_0\)</span> vs <span class="math inline">\(H_1:\mu\neq\mu_0\)</span>.</p>
<ul>
<li><p><strong>No existe UMP</strong> en general para alternativas bilaterales.<br></p></li>
<li>
<p>Se usa el test <strong>más potente imparcial (MPI)</strong>:</p>
<p><span class="math display">\[
\text{Rechazar }H_0 \text{ si } \left|\overline{X}_n-\mu_0\right|
\ge z_{1-\alpha/2}\,\frac{\sigma}{\sqrt{n}}
\]</span></p>
</li>
<li>
<p>Su <strong>potencia</strong> es:</p>
<p><span class="math display">\[
\eta(\mu)=1-\Big[\Phi\!\Big(z_{1-\alpha/2}-\frac{\sqrt{n}}{\sigma}(\mu-\mu_0)\Big)
        -\Phi\!\Big(-z_{1-\alpha/2}-\frac{\sqrt{n}}{\sigma}(\mu-\mu_0)\Big)\Big]
\]</span></p>
</li>
</ul>
<p><strong>Intuición clave</strong> - Con RVM, “valores grandes de <span class="math inline">\(\overline{X}_n\)</span> favorecen <span class="math inline">\(\mu\)</span> grandes”, por eso la <strong>región crítica es de cola</strong> y el test es <strong>UMP</strong> en el caso unilateral.<br>
- En bilateral no hay un único sentido de “grande”, por eso no existe UMP; el test adecuado es <strong>MPI</strong>.</p>
</div>
</div>
</section></section><section id="referencias" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="referencias">
<span class="header-section-number">4.7</span> Referencias</h2>
<ul>
<li><p><strong>Gómez, Guadalupe</strong>, &amp; <strong>Delicado, Pedro</strong> (2006). <em>Curso de Inferencia y Decisión</em>. Departament d’Estadística i Investigació Operativa, Universitat Politècnica de Catalunya.</p></li>
<li><p><strong>Wackerly, D. D., Mendenhall, W.</strong>, &amp; <strong>Scheaffer, R. L.</strong> (2008). <strong>Estadística matemática con aplicaciones</strong> (7ª ed.). Cengage Learning.</p></li>
<li><p><strong>Roussas, G. G.</strong> (1997). <strong>A Course in Mathematical Statistics</strong> (2nd ed.). Academic Press.</p></li>
<li><p><strong>Kalbfleisch, J. G. Probability and Statistical Inference</strong>. Springer-Verlag, 1985.</p></li>
</ul>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./chapter2.html" class="pagination-link" aria-label="Estimación puntual">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Estimación puntual</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter4.html" class="pagination-link" aria-label="Estimación por intervalos">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimación por intervalos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>